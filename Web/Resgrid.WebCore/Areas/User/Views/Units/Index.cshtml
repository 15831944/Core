@using Resgrid.Model
@using Resgrid.Web.Helpers
@model Resgrid.Web.Areas.User.Models.Units.UnitsIndexView
@{
  ViewBag.Title = "Resgrid | Units";
}

<style>
  .k-grid-content {
	padding-bottom: 300px;
  }

  .multi-level {
	z-index: 9999999999 !important;
	overflow: visible !important;
  }

  .dropdown-submenu {
	position: relative;
	z-index: 9999999999 !important;
	overflow: visible !important;
  }

	.dropdown-submenu > .dropdown-menu {
	  top: 0;
	  left: 100%;
	  margin-top: -6px;
	  margin-left: -1px;
	  -webkit-border-radius: 0 6px 6px 6px;
	  -moz-border-radius: 0 6px 6px;
	  border-radius: 0 6px 6px 6px;
	  z-index: 9999999999 !important;
	  overflow: visible !important;
	}

	.dropdown-submenu:hover > .dropdown-menu {
	  display: block;
	}

	.dropdown-submenu > a:after {
	  display: block;
	  content: " ";
	  float: right;
	  width: 0;
	  height: 0;
	  border-color: transparent;
	  border-style: solid;
	  border-width: 5px 0 5px 5px;
	  border-left-color: #ccc;
	  margin-top: 5px;
	  margin-right: -10px;
	  position: relative;
	  z-index: 9999999999 !important;
	  overflow: visible !important;
	}

	.dropdown-submenu:hover > a:after {
	  border-left-color: #fff;
	}

	.dropdown-submenu.pull-left {
	  float: none;
	}

	  .dropdown-submenu.pull-left > .dropdown-menu {
		left: -100%;
		margin-left: 10px;
		-webkit-border-radius: 6px 0 6px 6px;
		-moz-border-radius: 6px 0 6px 6px;
		border-radius: 6px 0 6px 6px;
		z-index: 9999999999 !important;
		overflow: visible !important;
	  }
</style>

<div class="row wrapper border-bottom white-bg page-heading">
  <div class="col-sm-4">
    <h2>Units List</h2>
    <ol class="breadcrumb">
      <li>
        <a asp-controller="Home" asp-action="Dashboard" asp-route-area="User">Home</a>
      </li>
      <li class="active">
        <strong>Units</strong>
      </li>
    </ol>
  </div>
  @if (ClaimsAuthorizationHelper.IsUserDepartmentAdmin() && Model.CanUserAddUnit)
  {
    <div class="col-sm-8">
      <div class="btn-group top-page-buttons" style="float:right;padding-right:15px;">
        <a title="Add a new unit" class="btn btn-success" asp-controller="Units" asp-action="NewUnit" asp-route-area="User">New Unit</a>
      </div>
    </div>
  }
</div>

<div class="row">
  <div class="col-xs-12">
    <div class="wrapper wrapper-content">
      <div class="ibox float-e-margins">
        <div class="ibox-content">
          <div id="unitsIndexList"></div>
        </div>
      </div>
    </div>
  </div>
</div>


@section Scripts
  {
  <script id="state-template" type="text/x-kendo-template">
    #if(StateId <= 25){#
    <span class='label #=StateColor#'>#=State#</span>
    #}else{#
    <span class='label label-default' style="color:#=TextColor#;background-color:#=StateColor#;">#=State#</span>
    #}#
  </script>

  <script id="unitstatus-template" type="text/x-kendo-template">
    <div class="btn-group" style="position: absolute;" data-id="#=UnitId#">
      <a class="btn btn-xs btn-primary dropdown-toggle stateDropdown" data-toggle="dropdown" data-id="#=UnitId#" href="" style="top: -14px;">
        Set State <span class="caret"></span>
      </a>
    </div>
  </script>

  <script id="unitcommand-template" type="text/x-kendo-template">
    <a type="button" href="@Url.Action("ViewEvents", "Units", new {area = "User"})?unitId=#=UnitId#" class="btn btn-xs btn-primary">View Events</a>
    <a type="button" href="@Url.Action("ViewLogs", "Units", new {area = "User"})?unitId=#=UnitId#" class="btn btn-xs btn-info">Logs</a>

    @if (ClaimsAuthorizationHelper.IsUserDepartmentAdmin())
	{
      <a type="button" href="@Url.Action("EditUnit", "Units", new {area = "User"})?unitId=#=UnitId#" class="btn btn-xs btn-warning">Edit</a>
      <a type="button" href="@Url.Action("DeleteUnit", "Units", new {area = "User"})?unitId=#=UnitId#" class="btn btn-xs btn-danger" data-confirm="WARNING: This will permanently delete this unit. Are you sure you want to delete the unit #=Name#?" rel="nofollow">Delete</a>
	}
  </script>

  <script src="~/js/app/internal/units/resgrid.units.index.js" type="text/javascript"></script>
}
